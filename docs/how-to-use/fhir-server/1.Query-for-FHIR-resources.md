# FHIR REST API Standard

## Overview

This FHIR Server follows the FHIR REST API standard, allowing you to query for all resources using standard FHIR operations.

For complete FHIR REST API documentation, visit:
https://www.hl7.org/fhir/http.html

## Security Enabled
By default, this FHIR Server is protected by our ID Server. To query for any resources, we have to get an Access Token from ID Server and use that token in request's Authorization Bearer

To obtain an Access Token, check the document in [`docs/how-to-use/id-server`](../id-server/2.Get-Access-Token-through-different-authentication-flows)

## How to use

Remeber for each step below, we have to replace the host IP to your host IP, if your host IP is different than `192.168.56.1`

### Import some Medical resource sample

You can import some sample data for testing purposes. To import, simply open Bash and run this Bash command in `root` folder.

```sh
chmod +x fhir-server/sample/import.sh
./fhir-server/sample/import.sh
```

### Get a quick token for example

You can call this request in Bash (if your machine have `curl` already) to immediately get an Access Token and operate with FHIR Server using it

```bash
curl -X POST \
  http://192.168.56.1:8080/realms/fhir-realm/protocol/openid-connect/token \
  -H 'Content-Type: application/x-www-form-urlencoded' \
  -d 'grant_type=client_credentials' \
  -d 'client_id=inferno-ehr' \
  -d 'client_secret=XfccslJAZwBk1AT1JzdV2tee5rHEAzAG' \
  -d 'scope=openid%20fhirUser%20system%2F%2A.%2A'
```

If your machine doesn't have `curl`, open PowerShell and copy this to your shell

```shell
$response = Invoke-RestMethod -Uri "http://192.168.56.1:8080/realms/fhir-realm/protocol/openid-connect/token" `
  -Method Post `
  -ContentType "application/x-www-form-urlencoded" `
  -Body "grant_type=client_credentials&client_id=inferno-ehr&client_secret=XfccslJAZwBk1AT1JzdV2tee5rHEAzAG&scope=openid%20fhirUser%20system%2F%2A.%2A"
Write-Output $response.access_token
Pause
```

From the response, copy the Access Token and use it for some example queries below

### Example Queries

We recommend using Postman, Insomnia, or some alternatives for API requests; as it provides a clear and user-friendly interface to visualize, test, and manage your API interactions

```
# Get All Patients
GET http://192.168.56.1:8090/fhir/Patient
Authorization: Bearer YOUR_ACCESS_TOKEN

# Get Specific Patient by ID
GET http://192.168.56.1:8090/fhir/Patient/42
Authorization: Bearer YOUR_ACCESS_TOKEN

# Search Patients by Name
GET http://192.168.56.1:8090/fhir/Patient?name=Turner526
Authorization: Bearer YOUR_ACCESS_TOKEN

# Get Patient's Observations
GET http://192.168.56.1:8090/fhir/Observation?patient=Patient/42
Authorization: Bearer YOUR_ACCESS_TOKEN

# Create New Patient (you can use the sample data in fhir-server/sample/data)
POST http://192.168.56.1:8090/fhir/Patient
Authorization: Bearer YOUR_ACCESS_TOKEN
Content-Type: application/fhir+json
{
  "resourceType": "Patient",
  "name": [{
    "family": "Doe",
    "given": ["John"]
  }]
}

# Update Patient
PUT /fhir/Patient/42
Authorization: Bearer YOUR_ACCESS_TOKEN
Content-Type: application/fhir+json
{
  "resourceType": "Patient",
  "name": [{
    "family": "Doe",
    "given": ["John"]
  }]
}
```

## Supported Operations

- READ (GET)
- SEARCH (GET with parameters)
- CREATE (POST)
- UPDATE (PUT)
    
All standard FHIR search parameters and modifiers are supported.